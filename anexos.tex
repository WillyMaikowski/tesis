\appendix
\chapter{Código de la Implementación}

%Colores PHP
\newcommand{\PHPamountofcolor}{75}
\newcommand{\SourceCodeContext}{5}
\definecolor{PHP_comment_old}{HTML}{CCCCCC}
\colorlet{PHP_comment}{PHP_comment_old!\PHPamountofcolor!black}
\definecolor{PHP_default_old}{HTML}{000000}
\colorlet{PHP_default}{PHP_default_old!\PHPamountofcolor!black}
\definecolor{PHP_keyword_old}{HTML}{6c9c11}
\colorlet{PHP_keyword}{PHP_keyword_old!\PHPamountofcolor!black}
\definecolor{PHP_emph1_old}{HTML}{0F58A2}
\colorlet{PHP_emph1}{PHP_emph1_old!\PHPamountofcolor!black}
\definecolor{PHP_emph2_old}{HTML}{CCAA00}
\colorlet{PHP_emph2}{PHP_emph2_old!\PHPamountofcolor!black}
\definecolor{PHP_emph4_old}{HTML}{C60484}
\colorlet{PHP_emph4}{PHP_emph4_old!\PHPamountofcolor!black}
\definecolor{PHP_string_old}{HTML}{C78F0A}
\colorlet{PHP_string}{PHP_string_old!\PHPamountofcolor!black}
\definecolor{PHP_variable_old}{HTML}{C82210}
\colorlet{PHP_variable}{PHP_variable_old!\PHPamountofcolor!black}
\definecolor{PHP_number_old}{HTML}{BF1CA6}
\colorlet{PHP_number}{PHP_number_old!\PHPamountofcolor!black}
\newtoggle{InString}{}
\togglefalse{InString}
\newcommand*{\ColorIfNotInString}[1]{\iftoggle{InString}{#1}{\color{PHP_number}#1}}
\newcommand{\PHPhighlightvar}[1]{\ifnum\theDollarFlag=1 \color{PHP_variable} \fi#1\setcounter{DollarFlag}{0}}
\newcounter{DollarFlag}

\lstset{
	language				= PHP, 
	breaklines			= true, 
	basicstyle			= \footnotesize, 
	keywordstyle 		= \color{PHP_keyword},
	stringstyle 		= \color{PHP_string!90!black}\toggletrue{InString},
	literate 				= {\$}{{\iftoggle{InString}{\$}{\setcounter{DollarFlag}{1}\color{PHP_variable}\$\color{PHP_default}}}}1
	{0}{{{\ColorIfNotInString{0}}}}1
	{1}{{{\ColorIfNotInString{1}}}}1
	{2}{{{\ColorIfNotInString{2}}}}1
	{3}{{{\ColorIfNotInString{3}}}}1
	{4}{{{\ColorIfNotInString{4}}}}1
	{5}{{{\ColorIfNotInString{5}}}}1
	{6}{{{\ColorIfNotInString{6}}}}1
	{7}{{{\ColorIfNotInString{7}}}}1
	{8}{{{\ColorIfNotInString{8}}}}1
	{9}{{{\ColorIfNotInString{9}}}}1,
	identifierstyle = \color{PHP_default}\PHPhighlightvar,
	commentstyle 		= \color{PHP_comment}\slshape,
	emph 						=[1]{require_once, require, include_once, include, namespace, use, class, function, new},
	emphstyle 			=[1]\color{PHP_emph1},%\bf,
	emph 						=[2]{echo, empty, isset, array, instanceof},
	emphstyle 			=[2]\color{PHP_emph2},%\bf,
	emph 						=[3]{var, const, abstract, protected, private, public, static, final, extends, implements, global, if, else, foreach ,for, endforeach, endif, endfor, elseif, as},
	emphstyle 			=[3]\color{PHP_keyword},%\bf,
	emph 						=[4]{return, throw, exit, __halt_compiler, continue, break},
	emphstyle 			=[4]\color{PHP_emph4},%\bf,
	captionpos 			= b,
	rulecolor 			= \color{black},
	keywords 				= {__halt_compiler, abstract, and, array,as, break, callable, case, catch, class,clone, const, continue, declare, default,die, do, echo, else, elseif, empty, enddeclare, endfor, endforeach, endif, endswitch, endwhile, eval, exit, extends, final, finally, for, foreach, function, global, goto, if, implements, include, include_once, instanceof, insteadof, interface, isset, list, namespace, new, or, print, private, protected, public, require, require_once, return, static, switch, throw, trait, try, unset, use, var, while, xor, yield },
	numbers					= left,
	stepnumber			= 1, 
	numberfirstline	= true,
	numberstyle			= \footnotesize,
	upquote					= true,
	showlines				= true
}

\lstinputlisting[firstline=6,lastline=319]{codigo/api.php}
