\chapter{El Problema: Situacion Actual}

El recuento de créditos inicialmente era un proceso netamente manual. Estaba constituido por un solo actor que a partir de la experiencia podía manejar las diferentes condiciones que se generaban. Ante eventualidades, como casos extraños en el que faltaban UD's en cierto plan, el mismo actor tenia la potestad de flexibilizar las reglas para chequear si realmente un alumno cumplía con la carrera.

Como se mencionó en la descripción del proyecto, este proceso fue mejorando poco a poco logrando que existieran componentes automáticas en el procedimiento, tratando de suplir todo el conocimiento generado por el actor mencionado en el párrafo anterior. Aun así, la parte automatizada posee errores de tal manera que se debe realizar un chequeo manual posterior.

Los errores se deben a la complejidad de las reglas que se deben cumplir y a la naturaleza del problema. Por ende, se ahondará en ello en la sección ``Combinaciones'' explicando el modelo e implementación actual.

Finalmente, en la sección del proceso actual se abordará el procedimiento realizado por el SGD para suplir la falta de certeza de la heurística en ciertos casos y las estadísticas de ocurrencia de los errores.


\section{Combinaciones}

Para entender el problema de forma mas detallada podemos realizar un simplificación del recuento y reducirlo a un problema de mudanza (bin packing). Para ello debemos asimilar los planes como si fueran cajas, y los ramos como si fueran elementos que deben ser guardados dentro de estas cajas para poder ser trasladados.

Para este problema la solución trivial seria ir intentando distintas combinaciones posibles de tal manera de lograr que todos los elementos sean guardados. Esto seria la solución a fuerza bruta del problema entregando la mejor solución pero el tiempo necesario para realizar todas combinaciones posibles es muy grande. No se posee un tiempo ilimitado y, por ende, lo mas natural sería comenzar a privilegiar algunos elementos guardando inicialmente los de mayor valor para luego ir rellenando con los de menor valor o los que se podrían dejar olvidados (como lo realizado por Martello y Toth descrito en el ``Marco Teórico'').

En el caso de la solución presente del recuento de UD's se utiliza la anterior heuristica. Se consideran los ramos de valor aquellos que poseen mayor nota y son de nivel mas alto (se debe privilegiar poner los ramos de mejor nota en la carrera debido a que ellos son considerados para el promedio final). Finalmente, esto iría mediante backtracking visitando todas las soluciones posibles pero teniendo en un inicio ramos de importancia fijos.

Matemáticamente, se puede definir que un ramo $r$ puede pertenecer a cierto conjunto de planes $P_r$ de tamaño $n_r$, y que un plan se ve cubierto si y solo si tiene asignado una cantidad determinada de ramos mayor o igual a $L_p$. Por lo anterior, el determinar el cumplimiento del plan y la nota se trata de un problema de asignación en el que se puede usar el ramo en alguno de sus planes. Si consideramos $X_{rp} \in \{0,1\}$ como la variable de decisión que determina si se usa el ramo $r$ en el plan $p$, el modelamiento del problema de calcular si se cumple el plan quedaría determinado por:

$$ max \sum_{r}^{Ramos} \sum_{p}^{Planes} X_{rp} $$
$$ s.a.\ \ \ \sum_{r}^{Ramos} X_{rp} > L_{p} \ \ \ \ \forall p \in planes $$
$$ \sum_{p}^{P_{r}} X_{rp} \leq 1 \ \ \wedge \sum_{p}^{planes \setminus P_{r}} X_{rp} \leq 0 \ \ \ \ \forall r \in ramos $$

De esta forma, el orden de complejidad de este modelo vendría dado por la pitatoria $ \prod_{r} n_{r} $. Es decir, en el caso hipotetico en que $m$ ramos tuvieran tres opciones donde ser ubicados se tendría $ \prod_{r} 3 \Rightarrow O(3^m)$, lo que equivale a un orden de complejidad exponencial. A partir de esto se descarta la posibilidad de un problema mucho mayor en que al ser combinaciones de todos los ramos contra todos los planes se obtendría un orden factorial de complejidad. 

Como se posee poco tiempo en un sitio web, este modulo es detenido a los quince segundos y por lo tanto puede suceder que hasta ese tiempo no se haya visitado una combinación que diga que todos los planes se cumplen siendo que quizás mas adelante podría encontrarla. En el caso del calculo de la nota se sigue el mismo comportamiento debido a que se realiza en conjunto con la comprobación del cumplimiento del plan principal. 

Si bien se asegura que se tiene una buena distribución porque se asignaron los ramos de importancia, no se tiene certeza de la correctitud en el punto donde es detenido el algoritmo. Aun así, se privilegió este procedimiento porque estos casos generan un falso negativo, es decir, el error que puede producir es que un alumno que puede titularse el sistema le diga que aun no puede. Para estos sucesos se siguen los pasos que se explicaran en la sección de ``proceso presente''.  

Aun así, lo descrito anteriormente solo es una relajación del problema. Si se consideran todas las reglas especificas de cada plan se puede armar un modelo como sigue:

$$ max\ \ usar_{carr,carr} \ \ :\ carr \in planes $$
$$ s.a. \sum_{p}^{planes} usar_{op} \leq 1 \ \ \ \forall o \in objetos \setminus o \neq p $$
$$ usar_{pp} \leq usar_{op} \ \ \ \forall p \in planes, \forall o \in objetos\ \setminus\ regla_{p} = todo \wedge pertenece_{op} = 1 $$
$$ usar_{pp} \cdot cantidad_{p} \leq contar_{p} \ \ \ \forall p \in planes\ \setminus\ regla_{p} = contar $$
$$ usar_{pp} \cdot cantidad_{p} \leq uds_{p} \ \ \ \forall p \in planes\ \setminus\ regla_{p} = ud $$
$$ usar_{pq} \leq contar_{p} \ \ \ \forall p,q \in planes\ \setminus\ regla_{p} = contar \wedge pertenece_{pq} = 1 $$
$$ usar_{pq} \leq uds_{p} \ \ \ \forall p,q \in planes\ \setminus\ regla_{p} = ud \wedge pertenece_{pq}=1 $$
$$ usar_{pq} \leq usar_{pp} \ \ \ \forall p,q \in planes\ \setminus\ regla_{p} = todo \wedge pertenece_{pq}=1 $$

En este modelo se generaliza lo que son los ramos y los planes debido a que se comportan de manera parecida. Es decir, como un plan puede poseer tanto ramos como subplanes y además un ramo puede verse como un plan debido a que puede poseer equivalencias, finalmente pueden modelarse como un único conjunto llamado objetos ($ramos \cup planes$). Además, puede utilizarse una variable que en el modelo le llamamos ``Usar'' que implica que un elemento ``i'' esta siendo usado en un elemento ``j'' de tal manera que esto implica los objetos considerados dentro de un plan. Un objeto estaría siendo usado en si mismo si y solo si es un ramo aprobado o es un plan donde se cubren todas las reglas relativas a él, y por ende de esta manera se podría verificar cuando una carrera se cumple.

De esta manera las restricciones vendrían a explicar reglas parecidas al modelo simplificado como que un objeto puede ser usado solo una ocasión, que cuando se tiene una regla ``todo'' se deben usar todos los elementos dentro de él y que cuando se tiene regla ``contar'' o ``uds'' se debe utilizar una cantidad mayor o igual a la determinada. 

La forma que esta implementado actualmente el sistema es mediante backtracking. Es decir, lo que se realiza es tomar un ramo de una lista, fijar el plan donde puede ser utilizado (escogiendo el primero de los candidatos para ese ramo) y continuar con el ramo siguiente. En cada paso se va evaluando si la solución que se tiene en ese instante es mejor que una guardada en una variable global y si lo fuese se actualiza esa variable. Luego, cuando todos los ramos se asignaron, el algoritmo debe ir devolviéndose de manera tal de ir probando los siguientes candidatos de cada ramo pero volviendo a calcular las combinaciones de los ramos siguientes porque cambió la situación. 

Ejemplificando, si se poseen tres ramos A, B y C, se deben asignar los dos primeros y calcular todas las opciones para C. Luego, se debe retroceder un paso, cambiar el candidato de B y volver a calcular las opciones de C. Asi de manera sucesiva hasta lograr calcular todas las opciones de B y A, respectivamente. Como se dijo anteriormente, no se posee un tiempo infinito y, por ende, el algoritmo debe detenerse, por lo tanto es probable que no se logre retroceder hasta A y solo se quede con el calculo de las mejores opciones de B y C. Es por ello que los ramos determinados en un principio deben asignarse de la mejor manera posible para que el costo de dejar el algoritmo inconcluso se minimice.


\section{Proceso Presente}

Inicialmente, gran parte del recuento de UD's pertenecía a ``Secretaria de Estudios'' ya que ellos verificaban el cumplimiento de los requisitos académicos del proceso de titulación. Aun así, por la complejidad del proceso y las fallas encontradas en el modulo automático la Subdirección de Gestión Docente (SGD) debió ser parte del proceso para generar una propuesta inicial.

Este proceso inicia con la aprobación de un ramo terminal. Es decir, al cumplir un ramo que esta cercano al termino de la carrera se puede confirmar que un alumno va necesitar la comprobación de sus antecedentes académicos. Inicialmente, eso si, es necesario procesar la licenciatura asociada a la carrera del alumno para proseguir normalmente.

\begin{figure}[!h]
	\centering
	\includegraphics[scale=0.46]{imagenes/7_5}
	\caption{Imagen del modulo de titulación donde se muestran los procesos necesarios para comprobar los requisitos académicos.}
	\label{req_academicos}
\end{figure}

Luego, el SGD valida el resultado entregado por el modulo del recuento de UD's verificando que no se este en presencia de un falso negativo. Esto se evidencia ya que el sistema menciona que el alumno no cumple el plan y existen ramos no usados que con un re-ordenamiento de los ramos utilizados pueden disponerse y lograr una combinación válida.

La búsqueda de una combinación puede ser lenta y por ello se pueden recibir notificaciones de parte del alumno que busca que su proceso continúe como es debido. Además, él posee mucho mayor conocimiento de su avance curricular y por ende puede ayudar a la búsqueda de la solución. Dado esto, existe un modulo en U-Campus que permite la interacción entre alumnos e integrantes del SGD.

\begin{figure}[!h]
	\centering
	\includegraphics[scale=0.55]{imagenes/8}
	\caption{Estadisticas de peticiones por dia relacionadas al recuento de UD's.}
	\label{estadisticas_sgd}
\end{figure}

Se posee un promedio de dos consultas por dia relacionadas con el recuento. Estas son resueltas comúnmente en algunos días pero existen ocasiones en que toman mayor tiempo (meses) debido a que involucran normas adicionadas en los cambios de planes de estudios. Esto esta íntimamente relacionado con las versiones de los planes explicadas en la descripción del proyecto.

Finalmente, cuando ya se posee una combinación valida o cuando el alumno aprueba lo necesario para el cumplimiento del plan, se envía el resultado del sistema con observaciones de los cambios necesarios para obtener la combinación valida si se requiere. Esta es recibida por Secretaria de Estudios quien valida la propuesta donde la acepta confirmando el cumplimiento de los requisitos académicos o la rechaza para que el SGD justifique de mejor manera las observaciones agregadas.

Otros de los procesos que tiene a cargo el SGD son la inscripción académica, el catalogo de cursos, el calendario académico, entre otros. Muchos de ellos presentan alta carga y con tasas de errores dependientes del tiempo involucrado en ellos para una correcta planificación. Si se posee una mejora en la certeza del recuento de UD's se disminuirían los reclamos por parte del alumnado y la cantidad de rechazos por parte de Secretaria de Estudios.


